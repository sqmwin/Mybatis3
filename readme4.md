[TOC]

# 4. 查询缓存

## 4.1 一级查询缓存

### 4.1.1 一级查询缓存的存在性证明

#### 1. 修改测试类

#### 2. 查看控制台

###4.1.2 从缓存读取数据的依据是Sql 的 id

#### 1. 修改映射文件

#### 2. 修改dao层接口

#### 3. 修改测试类

#### 4. 查看控制台

### 4.1.3 增删改操作对一级查询缓存的影响

#### 1. 修改测试类

#### 2. 查看控制台

## 4.2 内置二级查询缓存

### 4.2.1 二级缓存用法

#### 1. 实体序列化

#### 2. mapper 映射中添加\<cache/>标签

#### 3. 二级缓存配置

###4.2.2 二级查询缓存的存在性证明

#### 1. 修改测试类

#### 2. 查看控制台

### 4.2.3 增删改操作对一级查询缓存的影响

#### 1. 默认对缓存的刷新

##### 1. 修改测试类

##### 2. 查看控制台

#### 2. 设置删改操作不刷新二级缓存

### 4.2.4 二级缓存的关闭

1.  全局关闭
2.  局部关闭

### 4.2.5 二级缓存使用原则

1.  只能在一个命名空间下使用二级缓存
2.  在单表上使用二级缓存
3.  查询多于修改时使用二级缓存

## 4.3 ehcache二级查询缓存

1.  导入jar包
2.  添加ehcache.xml配置文件
    1.  **\<diskStore/>标签**
    2.  **\<defaultCache/>标签**

### 4.3.1 启用ehcache 缓存机制

### 4.3.2 ehcache 在不同 mapper 中的个性化设置

# 5. MyBatis注解式开发

## 5.1 注解的基础知识

1.  注解的基础语法
2.  注解的注解
3.  注解的属性
    1.  数组问题
    2.  默认值问题
    3.  value属性问题
    4.  无属性问题

## 5.2 MyBatis注解

1.  **@Insert**
2.  **@SelectKey**
3.  **@Delete**
4.  **@Update**
5.  **@Select**

## 5.3 程序举例

1.  修改dao接口
2.  删除映射文件
3.  修改主配置文件